# مرجع API السريع

## العنوان الأساسي

```
http://localhost:5000/api
```

---

## المصادقة

| الطريقة | المسار                  | الوصف                  | مصادقة | الصلاحية               |
| ------- | ----------------------- | ---------------------- | ------ | ---------------------- |
| POST    | `/auth/register`        | تسجيل جديد             | ❌     | —                      |
| POST    | `/auth/login`           | تسجيل الدخول           | ❌     | —                      |
| POST    | `/auth/refresh`         | تحديث الجلسة           | ❌     | —                      |
| POST    | `/auth/logout`          | تسجيل الخروج           | ✅     | —                      |
| GET     | `/auth/me`              | بيانات المستخدم الحالي | ✅     | `AUTH_VIEW_SELF`       |
| POST    | `/auth/change-password` | تغيير كلمة المرور      | ✅     | `AUTH_CHANGE_PASSWORD` |

---

## الافراد

| الطريقة | المسار                   | الوصف             | الصلاحية              |
| ------- | ------------------------ | ----------------- | --------------------- |
| POST    | `/users`                 | إنشاء مستخدم      | `USERS_CREATE`        |
| GET     | `/users`                 | قائمة المستخدمين  | `USERS_VIEW`          |
| GET     | `/users/:id`             | جلب مستخدم        | `USERS_VIEW`          |
| PATCH   | `/users/:id`             | تحديث مستخدم      | `USERS_UPDATE`        |
| DELETE  | `/users/:id`             | حذف مستخدم (ناعم) | `USERS_DELETE`        |
| POST    | `/users/:id/avatar`      | رفع صورة شخصية    | `USERS_UPLOAD_AVATAR` |
| POST    | `/users/:id/lock`        | قفل حساب          | `USERS_LOCK`          |
| POST    | `/users/:id/unlock`      | فتح حساب          | `USERS_UNLOCK`        |
| POST    | `/users/:id/tags`        | إدارة الوسوم      | `USERS_TAGS_MANAGE`   |
| POST    | `/users/:id/family/link` | ربط فرد عائلة     | `USERS_FAMILY_LINK`   |

---

## نقاط نهاية عامة

| الطريقة | المسار    | الوصف                  |
| ------- | --------- | ---------------------- |
| GET     | `/health` | فحص صحة الخادم         |
| GET     | `/docs`   | توثيق Swagger التفاعلي |

---

## Headers المطلوبة

### لجميع الطلبات

```
Content-Type: application/json
```

### للطلبات المصادقة

```
Authorization: Bearer <accessToken>
```

### لرفع الملفات

```
Content-Type: multipart/form-data
Authorization: Bearer <accessToken>
```

---

## حدود المعدل (Rate Limiting)

| النوع       | الحد    | النافذة الزمنية |
| ----------- | ------- | --------------- |
| عام         | 100 طلب | 15 دقيقة        |
| المصادقة    | 20 طلب  | 15 دقيقة        |
| رفع الملفات | 30 طلب  | ساعة            |

---

## رموز حالة HTTP المستخدمة

| الرمز | المعنى                       |
| ----- | ---------------------------- |
| 200   | نجاح                         |
| 201   | تم الإنشاء بنجاح             |
| 400   | خطأ في البيانات المدخلة      |
| 401   | غير مصادق (يجب تسجيل الدخول) |
| 403   | ممنوع (بدون صلاحية)          |
| 404   | غير موجود                    |
| 409   | تعارض (بيانات مكررة)         |
| 429   | تجاوز حد الطلبات             |
| 500   | خطأ داخلي في الخادم          |

---

## الفئات العمرية

| الفئة       | المدى العمري |
| ----------- | ------------ |
| طفل         | 0 - 12 سنة   |
| مراهق       | 13 - 18 سنة  |
| شاب         | 19 - 39 سنة  |
| متوسط العمر | 40 - 59 سنة  |
| كبير سن     | 60+ سنة      |

تُحسب تلقائياً من تاريخ الميلاد وتُحدّث عند كل حفظ.

---

## أسباب قفل الحساب

| السبب                     |
| ------------------------- |
| قرار إداري                |
| اختراق أمني               |
| سلوك غير لائق             |
| عدم نشاط                  |
| محاولات دخول فاشلة متعددة |
| مشاكل في سلامة البيانات   |
| سبب آخر                   |
